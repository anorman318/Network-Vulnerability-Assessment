# Network-Vulnerability-Assessment
Analyzed a network to provide a summary of findings  

You have just been hired by RockStar Corporation as a network security analyst.  
* RockStar Corp has recently built a new office in Hollywood, California. You are tasked with completing a network vulnerability assessment of the office.  
* You will complete several steps in order to analyze the Hollywood network and then provide RockStar Corp a summary of your findings.  
* RockStar Corp is also concerned that a malicious hacker may have infiltrated their Hollywood office. You will need to determine whether there is anything suspicious in your findings.  

**Phase 1: "I'd like to Teach the World to ping"**  
You have been provided a list of network assets belonging to RockStar Corp. Use fping to ping the network assets for only the Hollywood office.  
* Determine the IPs for the Hollywood office and run fping against the IP ranges in order to determine which IP(s) are accepting connections.  
* RockStar Corp doesn't want any of their servers, even if they are up, to indicate that they are accepting connections.  
* Use fping <IP Address> and ignore any results that say "Request timed out."  

1. Command(s) used to run fping against the IP ranges:  

fping -g 15.199.95.91/28  
fping -g 15.199.94.91/28  
fping -g 11.199.158.91/28  
fping -g 161.35.96.20/32  
fping -g 11.199.141.91/28  

<img width="318" alt="11a" src="https://user-images.githubusercontent.com/106919343/200672027-b6ec05f0-e790-4e6e-8fc1-f81cf329a2e3.png">  

<img width="353" alt="11b" src="https://user-images.githubusercontent.com/106919343/200672046-f8b30e92-9071-4a24-8562-2f79a5de2086.png">  

2. Summarize the results of the fping command(s):  
Answer:  
Most of the IP addresses for the Hollywood office came back with an unreachable response from the fping command.  One IP address in the Hollywood Application Servers range of 161.35.96.20/32 came back with an is alive: 161.35.96.20  

3. List of IPs responding to echo requests:  
Answer:  
161.35.96.20

<img width="310" alt="13" src="https://user-images.githubusercontent.com/106919343/200672307-a990346b-3425-4a6c-ac16-5580ff21888a.png">  

4. Explain which OSI layer(s) your findings involve:  
Answer:  
This is a Layer 3, Network, finding as the command fping is sending a ping, in this case using IP addresses, to test the availability and accessibility of the host network.  

5. Mitigation recommendations (if needed):  
Answer:  
RockStar Corp has stated that they don’t want any of their servers to indicate that they are accepting connections.  One mitigation recommendation they could do is block all ICMP requests.  This will “hide” that they are online.  While blocking is a great security precaution it is not fool proof as hackers can still receive some information and see that they are online.  RockStar Corp could take this a step further and drop all ICMP requests as this would hide that your IP address is live completely.  

**Phase 2: "Some SYN for Nothin**  

Using your findings from Phase 1, determine which ports are open.  
* You will run a SYN scan against the IP(s) accepting connections. Follow the instructions in the SYN Scan Instructions section below.  
* Using the results of the SYN scan, determine which ports are accepting connections.  

1. Which ports are open on the RockStar Corp server?  
Answer:
22/tcp open SSH  
<img width="338" alt="21" src="https://user-images.githubusercontent.com/106919343/200672848-fd726d48-bc4d-4735-a9f4-dc1c0ff32382.png">  

2. Which OSI layer do SYN scans run on?   
    a. OSI Layer:  
      Answer: Layer 4: Transport  
     b. Explain how you determined which layer:  
      Answer: A SYN scan uses TCP, which is a connection oriented protocol occurring on the transport layer.  

3. Mitigation suggestions (if needed):  
Answer:
The recommended mitigation would be to turn off Port 22 and reassign access to a random port number above 1024. Port numbers 0 through 1023 are considered well known port numbers and assigning above this range would add an extra layer of protection.

**Phase 3: "I Feel a DNS Change Comin' On"**  
Using your findings from Phase 2, determine whether you can access the server(s) that accept connections.  
* RockStar typically uses the same default username and password for most of their servers, so try this first:  
    * Username: jimi  
    * Password: hendrix  
* Try to figure out which port/service would be used for remote system administration. Then, using these credentials, attempt to log in to the IP(s) that responded to pings in Phase 1.  

RockStar Corp recently reported that they are unable to access rollingstone.com in the Hollywood office. Sometimes when they try to access the website, a different, unusual website comes up.  
* While logged into the RockStar server from the previous step, determine whether something was modified on this system that might affect viewing rollingstone.com within the browser. When you successfully find the configuration file, record the entry that is set to rollingstone.com.  
*  Terminate your SSH session to the rollingstone.com server, and use nslookup to determine the real domain of the IP address that you found in the previous step.

1. Summarize your findings about why access to rollingstone.com is not working as expected from the RockStar Corp Hollywood office:  
Answer:  
When I logged into Rockstar Corp’s Hollywood server as Jimi I found in the /etc/hosts directory an IP address associated with rollingstone.com.  Once I recorded that information I exited out of my session as Jimi and ran an nslookup command.  I first ran it on the domain name; rollingstone.com and then again on the IP address found on Rockstar Corp’s server.  When I ran the command on rollingstone.com it came back with results that the server had from a cached record with the IP address of rollingstone.com.  When the command was run using the IP address found on the RockStar Corp’s server an unknown.yahoo.com came up for the name field.  This means it could not resolve a name for the IP address and it is more than likely incorrectly configured.  

2. Command used to query Domain Name System records:  
Answer:  
Nano hosts  
<img width="746" alt="3a" src="https://user-images.githubusercontent.com/106919343/200673706-acfe1dcb-6ba2-405c-a21b-53dc6c9d32bf.png">  

3. Domain name findings:  
Answer:  
<img width="446" alt="3c" src="https://user-images.githubusercontent.com/106919343/200673781-116077d9-0793-4e8f-868d-73cda5d9f30a.png">  
<img width="399" alt="3d" src="https://user-images.githubusercontent.com/106919343/200673842-1ef718db-a2c6-46c9-ac89-b6897f59a2bb.png">  

 4. Explain what OSI layer DNS runs on:  
Answer:  
DNS runs on the Application level, layer 7, of the OSI model.  DNS is used to translate the domains of a website into an IP address and runs in the background while a user interacts with a web or email application.  

5. Mitigation suggestions (if needed):  
Answer:  
RockStar Corp needs to go into the /etc/hosts file on their server and change the IP address that is found in the file with rollingstone.com to the correct one.  This along with the other mitigation suggestions suggested will help to harden their server.  Another mitigation the company can take is to apply DNS filtering services, which filters content into different groups based on their security risk; allowed, blocked, or greylisted.  If a hacker was able to reroute an IP address to a malicious site the DNS filter would block this site based on its categorization and prevent employees from accessing it. It was also stated that RockStar Corp uses the same default username and password for most of its servers; this is a bad practice and should be changed.  They should update the username and set up a password policy that indicates password length, adding in special characters, and using both numbers and letters as well as password expiration.  All of these would help to strengthen their password and make it harder for hackers to crack.  

**Phase 4: “ShARP Dressed Man”**  
Within the RockStar server that you SSH'd into, and in the same directory as the configuration file from Phase 3, the hacker left a note about where she stored some packet captures.  
* View the file to find out where to recover the packet captures.  
* These packets were captured from the activity in the Hollywood Office.  
* Use Wireshark to analyze this PCAP file and determine whether there was any suspicious activity that could be attributed to a hacker.  
* Record and identify your findings (i.e., OSI layers, protocols, IP addresses, MAC addresses, etc.).  

1. Name of file containing packets:  
Answer:  
Packetcaptureinfo.txt
<img width="661" alt="41" src="https://user-images.githubusercontent.com/106919343/200674418-9c9dd863-4f82-4f35-aefb-38fa01b90fb7.png">  
<img width="545" alt="42" src="https://user-images.githubusercontent.com/106919343/200674491-a22eda44-96d1-4e7a-a129-5c78fdf472be.png">  

2. ARP findings identifying the hacker’s MAC address:  
Answer:  
Hacker’s MAC address is 00:0c:29:1d:b3:b1 which we can determine by the duplicate IP address message generated for 192.168.47.200 
<img width="845" alt="4arp" src="https://user-images.githubusercontent.com/106919343/200674604-ff418fba-8cde-4894-9eb5-b26a74904cb4.png">  

3. HTTP findings, including the message from the hacker:  
Answer:  

<img width="857" alt="4http" src="https://user-images.githubusercontent.com/106919343/200674680-8ea5ab28-bd88-4631-877a-c675ddc5dfad.png">  

4. Explain the OSI layers for HTTP and ARP.  
    a. Layer used for HTTP:  
    Answer: Layer 7, Application, as HTTP is a key protocol used in this layer. HTTP uses requests and responses to load web pages that we the user see.  
    b. Layer used for ARP:  
    Answer:  ARP is part of Layer 2, Date Link Level, of the OSI model.  ARP maps MAC addresses to IP addresses.  

5. Mitigation suggestions (if needed):  
Answer:  
It is clear from the hacker’s email that they have discovered Port 22 is open and are ransoming off the username and password for the server.  The first mitigation would be to make sure Port 22 is indeed closed and reassigned to another Port number above 1024, as suggested above.  Second, they should make sure to change the login credentials for their servers from the default ones to logins that are more secure using the suggestions above.  Lastly, it is clear the hacker was able to capture packets of ARP activity which they can use to gather active IP addresses.  Hackers with this access can redirect traffic from the correct destination to the hacker’s malicious destination and gather classified or sensitive information.  RockStar Crop should install ARP spoofing detection software which will identify and block ARP poisoning attempts.  






